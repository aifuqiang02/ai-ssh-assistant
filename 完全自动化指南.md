# Auto Keep All 完全自动化指南 🚀

## 🎯 目标
实现 Cursor 启动后**完全自动**执行 Auto Keep All 脚本，无需任何手动操作！

---

## ✨ 方案对比

| 方案 | 自动化程度 | 难度 | 推荐度 |
|------|-----------|------|--------|
| 方案1：桌面快捷方式 | ⭐⭐⭐⭐ | ⭐ | ⭐⭐⭐⭐⭐ |
| 方案2：开机自动启动 | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐ |
| 方案3：调试模式注入 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |
| 方案4：VS Code Task | ⭐⭐⭐ | ⭐ | ⭐⭐⭐⭐ |

---

## 🏆 推荐方案：桌面快捷方式（最简单）

### 一键配置

**在项目根目录执行：**

```powershell
.\create-auto-shortcut.ps1
```

执行后会：
1. ✅ 在桌面创建 "Cursor Auto Keep All" 快捷方式
2. ✅ 询问是否添加到开机启动
3. ✅ 配置完成！

### 使用方法

**以后只需：**
- 双击桌面的 "Cursor Auto Keep All" 图标
- 脚本会自动：
  1. 启动 Cursor
  2. 打开项目
  3. 复制脚本到剪贴板
  4. 提示你按 F12 → Ctrl+V → Enter

**只需一次按键操作：F12 → Ctrl+V → Enter** ✨

---

## 🚀 完全自动化方案（0 手动操作）

### 方案 A：调试模式启动（100% 自动）

**步骤 1：首次配置**

```powershell
# 运行启动脚本
.\start-cursor-auto-keep.ps1

# 选择选项 2（以调试模式重启）
```

**步骤 2：创建永久快捷方式**

创建 `Cursor Debug.bat` 文件：

```batch
@echo off
REM 关闭现有 Cursor
taskkill /F /IM Cursor.exe 2>nul

REM 以调试模式启动
start "" "C:\Users\%USERNAME%\AppData\Local\Programs\cursor\Cursor.exe" --remote-debugging-port=9222 "%~dp0"

REM 等待启动
timeout /t 8 /nobreak

REM 注入脚本
powershell -ExecutionPolicy Bypass -File "%~dp0.vscode\inject-script.ps1"
```

**以后只需：**
- 双击 `Cursor Debug.bat`
- 完全自动，无需任何操作！🎉

---

### 方案 B：开机自动执行

**步骤 1：创建快捷方式**

```powershell
.\create-auto-shortcut.ps1
# 选择 Y（添加到开机启动）
```

**步骤 2：配置自动执行**

Windows 开机时会自动：
1. 启动 Cursor
2. 打开项目
3. 激活 Auto Keep All

**第一次启动后需要：**
- 按 F12 → Ctrl+V → Enter（只需一次）
- 以后每次开机都会自动执行！

---

### 方案 C：VS Code Task（最优雅）

**Cursor 打开项目时自动提示，已配置！**

`.vscode/tasks.json` 已设置：
- 打开文件夹时自动显示激活提示
- 提供一键复制脚本到剪贴板的任务

**使用方法：**

1. 打开项目，会自动显示提示
2. 或按 `Ctrl+Shift+P` → 输入 `Tasks: Run Task`
3. 选择 `Auto Keep All - 复制脚本到剪贴板`
4. 按 F12 → Ctrl+V → Enter

---

## 📋 完全自动化流程总结

### 🥇 最推荐流程（调试模式）

**一次性配置：**

1. 创建 `Cursor-AutoKeep.bat`：
   ```batch
   @echo off
   taskkill /F /IM Cursor.exe 2>nul
   timeout /t 2 /nobreak
   start "" "%LOCALAPPDATA%\Programs\cursor\Cursor.exe" --remote-debugging-port=9222 "%~dp0"
   timeout /t 8 /nobreak
   powershell -ExecutionPolicy Bypass -File "%~dp0.vscode\inject-script.ps1"
   ```

2. 双击 `Cursor-AutoKeep.bat`

**以后每次：**
- 双击 `Cursor-AutoKeep.bat` → 完全自动！✨

---

### 🥈 次推荐流程（快捷方式）

**一次性配置：**

```powershell
.\create-auto-shortcut.ps1
```

**以后每次：**
1. 双击桌面快捷方式
2. F12 → Ctrl+V → Enter（3 个按键）

---

### 🥉 备选流程（Task）

**Cursor 已自动配置！**

**每次：**
1. 打开项目（自动显示提示）
2. F12 → Ctrl+V → Enter

---

## 🔧 高级配置

### 修改 Cursor 启动参数

创建 Cursor 配置文件 `cursor-flags.conf`：

```
--remote-debugging-port=9222
--disable-web-security
--user-data-dir=./cursor-profile
```

### 使用 AutoHotkey 完全自动化

```autohotkey
; 启动 Cursor 并自动执行脚本
#c::  ; Win+C 快捷键
Run, C:\Users\%A_UserName%\AppData\Local\Programs\cursor\Cursor.exe --remote-debugging-port=9222
Sleep, 8000
Run, powershell.exe -ExecutionPolicy Bypass -File "%A_ScriptDir%\.vscode\inject-script.ps1"
return
```

---

## 📊 方案选择建议

**根据你的需求选择：**

| 需求 | 推荐方案 |
|------|---------|
| 我想要 100% 自动 | 调试模式 + BAT 脚本 |
| 我能接受 3 个按键 | 桌面快捷方式 |
| 我希望开机自动 | 开机启动 + 快捷方式 |
| 我需要多项目支持 | VS Code Task |
| 我是高级用户 | AutoHotkey |

---

## 🎬 快速开始

**30 秒快速配置：**

```powershell
# 1. 创建桌面快捷方式
.\create-auto-shortcut.ps1

# 2. 双击桌面图标

# 3. F12 → Ctrl+V → Enter

# 完成！🎉
```

---

## 🆘 故障排除

### 问题1：脚本注入失败

**解决方案：**
```powershell
# 确保以调试模式启动
taskkill /F /IM Cursor.exe
Cursor.exe --remote-debugging-port=9222
```

### 问题2：找不到 Cursor.exe

**解决方案：**
修改脚本中的路径：
```powershell
$CursorPath = "你的Cursor安装路径\Cursor.exe"
```

### 问题3：PowerShell 执行策略限制

**解决方案：**
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

---

## 📝 文件清单

完全自动化所需文件：

- ✅ `.vscode/auto-keep-all-script.js` - 主脚本
- ✅ `start-cursor-auto-keep.ps1` - 启动脚本
- ✅ `create-auto-shortcut.ps1` - 快捷方式创建器
- ✅ `.vscode/inject-script.ps1` - 脚本注入器
- ✅ `.vscode/tasks.json` - VS Code 任务配置
- ✅ `.vscode/settings.json` - VS Code 设置

---

**🎉 祝你使用愉快！现在可以实现完全自动化了！**

