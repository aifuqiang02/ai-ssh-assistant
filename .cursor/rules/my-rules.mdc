---
description: AI SSH Assistant é¡¹ç›®å¼€å‘è§„åˆ™å’Œæœ€ä½³å®è·µ
globs:
alwaysApply: true
---

# é¡¹ç›®å¼€å‘è§„åˆ™

## ğŸ—ï¸ æ¶æ„åŸåˆ™

### 1. åŒæ¨¡å¼æœåŠ¡æ¶æ„
- **å¿…é¡»**ä½¿ç”¨ç»Ÿä¸€çš„æœåŠ¡æ¥å£ï¼Œæä¾›æœ¬åœ°ï¼ˆLocal IPCï¼‰å’Œäº‘ç«¯ï¼ˆRemote APIï¼‰ä¸¤ç§å®ç°
- **ç¦æ­¢**åœ¨ç»„ä»¶ä¸­ç›´æ¥åˆ¤æ–­å­˜å‚¨æ¨¡å¼æˆ–ç›´æ¥è°ƒç”¨ IPC/API
- **ä½¿ç”¨** `createService(LocalImpl, ApiImpl)` è‡ªåŠ¨é€‰æ‹©å®ç°

```typescript
// âœ… æ­£ç¡®
import { chatService } from '@/services/chat.service'
const sessions = await chatService.getSessions()

// âŒ é”™è¯¯
if (isLocalMode) {
  await window.electronAPI.chat.getSessions()
} else {
  await fetch('/api/chat/sessions')
}
```

### 2. çŠ¶æ€ç®¡ç†
- **ç¦æ­¢**ä½¿ç”¨ Pinia Storeï¼ˆå·²å®Œå…¨åºŸå¼ƒå¹¶åˆ é™¤ï¼‰
- **ä½¿ç”¨** Vue Composables ç®¡ç†å…¨å±€ UI çŠ¶æ€ï¼ˆå¦‚ `useApp`, `useTheme`ï¼‰
- **ä½¿ç”¨**ç›´æ¥æœåŠ¡è°ƒç”¨è·å–ä¸šåŠ¡æ•°æ®
- **å­˜å‚¨ç›®å½•å·²åˆ é™¤**: `apps/desktop/src/stores/` ä¸åº”å†åˆ›å»º

### 3. userId å¤„ç†
- **ç¦æ­¢**ç»„ä»¶æ‰‹åŠ¨è·å–æˆ–ä¼ é€’ userId
- **å¿…é¡»**ç”±æœåŠ¡å±‚è‡ªåŠ¨å¤„ç†ï¼š
  - æœ¬åœ°æ¨¡å¼ï¼šå›ºå®šä½¿ç”¨ `'local-user'`
  - äº‘ç«¯æ¨¡å¼ï¼šä» JWT Token è‡ªåŠ¨æå–

```typescript
// âœ… æ­£ç¡® - æœåŠ¡å±‚è‡ªåŠ¨å¤„ç†
class ChatLocalImpl {
  async getSessions() {
    const userId = this.getUserId()  // è‡ªåŠ¨è¿”å› 'local-user'
    return window.electronAPI.chat.getSessions(userId)
  }
}

// âŒ é”™è¯¯ - ç»„ä»¶æ‰‹åŠ¨å¤„ç†
const userId = localStorage.getItem('userId')
await chatService.getSessions(userId)
```

## ğŸ“ ä»£ç è§„èŒƒ

### 1. API è·¯å¾„è§„èŒƒ
- **ç¦æ­¢**åœ¨ API å®ç°ä¸­æ·»åŠ  `/api` å‰ç¼€ï¼ˆBaseApiImpl å·²åŒ…å« `/api/v1`ï¼‰
- **æ ¼å¼**: `/æ¨¡å—/æ“ä½œ` æˆ– `/æ¨¡å—/:id`

```typescript
// âœ… æ­£ç¡®
class ChatApiImpl extends BaseApiImpl {
  async getChatTree() {
    return this.get('/chat/tree')  // æœ€ç»ˆ: /api/v1/chat/tree
  }
}

// âŒ é”™è¯¯
return this.get('/api/chat/tree')  // é”™è¯¯: /api/v1/api/chat/tree
```

### 2. IPC å‘½åè§„èŒƒ
- **æ ¼å¼**: `æ¨¡å—:æ“ä½œ`
- **ç¤ºä¾‹**: `chat:getChatTree`, `ssh:connect`, `settings:save`

```typescript
// âœ… æ­£ç¡®
ipcMain.handle('chat:getChatTree', ...)
ipcMain.handle('ssh:connect', ...)

// âŒ é”™è¯¯
ipcMain.handle('getChatTree', ...)  // ç¼ºå°‘æ¨¡å—å‰ç¼€
ipcMain.handle('chat_get_tree', ...)  // ä½¿ç”¨ä¸‹åˆ’çº¿
```

### 3. è·¯ç”±å“åº”æ ¼å¼è§„èŒƒ
- **å¿…é¡»**ä½¿ç”¨ç»Ÿä¸€çš„å“åº” Schema (`packages/server/src/schemas/common.schema.ts`)
- **ç¦æ­¢**ä¸ºæ¯ä¸ªè·¯ç”±é‡å¤å®šä¹‰è¯¦ç»†çš„ response schema
- **200 å“åº”**ç»Ÿä¸€ä½¿ç”¨ `successResponseSchema`ï¼ˆå…è®¸ä»»æ„å¯¹è±¡ï¼Œé¿å…åºåˆ—åŒ–é—®é¢˜ï¼‰

```typescript
// âœ… æ­£ç¡®
import { successResponseSchema } from '../schemas/common.schema.js'

fastify.get('/settings', {
  schema: {
    description: 'è·å–ç”¨æˆ·è®¾ç½®',
    tags: ['è®¾ç½®'],
    response: successResponseSchema  // ç»Ÿä¸€ä½¿ç”¨
  }
}, async (request, reply) => {
  return reply.send({
    success: true,
    message: 'è·å–æˆåŠŸ',
    data: { /* ä»»æ„ç»“æ„ */ }
  })
})

// âŒ é”™è¯¯ - é‡å¤å®šä¹‰ä¸”å¯èƒ½å¯¼è‡´åºåˆ—åŒ–é—®é¢˜
response: {
  200: {
    type: 'object',
    properties: {
      success: { type: 'boolean' },
      data: { type: 'object' }  // æ²¡æœ‰ additionalProperties: true
    }
  }
}
```

**ä¸ºä»€ä¹ˆä½¿ç”¨ç»Ÿä¸€ Schemaï¼Ÿ**
- âœ… é¿å… Fastify åºåˆ—åŒ–å™¨å› ç¼ºå°‘ `additionalProperties: true` è€Œè·³è¿‡å­—æ®µ
- âœ… ç»Ÿä¸€ç®¡ç†ï¼Œä¿®æ”¹å“åº”æ ¼å¼åªéœ€æ›´æ–°ä¸€ä¸ªåœ°æ–¹
- âœ… å‡å°‘é‡å¤ä»£ç ï¼Œæé«˜å¯ç»´æŠ¤æ€§
- âœ… å…è®¸åŠ¨æ€å­—æ®µï¼Œæ”¯æŒçµæ´»çš„å“åº”ç»“æ„

**å¯ç”¨çš„ Schema é€‰é¡¹**ï¼š
- `successResponseSchema` - ä»… 200 å“åº”
- `errorResponseSchema` - é”™è¯¯å“åº”ï¼ˆ400/401/404/500ï¼‰
- `standardResponseSchema` - å®Œæ•´å“åº”ï¼ˆæˆåŠŸ+é”™è¯¯ï¼‰

### 4. ç±»å‹å®šä¹‰åŒæ­¥
- **å¿…é¡»**åŒæ­¥æ›´æ–° `apps/desktop/src/types/electron.d.ts`
- Preload è„šæœ¬æ¯æ¬¡æ·»åŠ æ–° APIï¼Œéƒ½è¦æ›´æ–°ç±»å‹å®šä¹‰

### 5. Token ç®¡ç†
- **å­˜å‚¨ key**: å›ºå®šä½¿ç”¨ `'userToken'`ï¼ˆä¸æ˜¯ `'token'`ï¼‰
- **å­˜å‚¨ä½ç½®**: `localStorage` æˆ– `sessionStorage`
- **ç¦æ­¢**ç»„ä»¶æ‰‹åŠ¨å¤„ç† Tokenï¼Œç”±æœåŠ¡å±‚è‡ªåŠ¨å¤„ç†

```typescript
// âœ… æ­£ç¡®
localStorage.setItem('userToken', accessToken)

// âŒ é”™è¯¯
localStorage.setItem('token', accessToken)
```

## ğŸ—„ï¸ æ•°æ®å­˜å‚¨è§„èŒƒ

### 1. æœ¬åœ°å­˜å‚¨ï¼ˆSQLiteï¼‰
- **å·¥å…·**: better-sqlite3
- **è¡¨ç»“æ„**:
  ```sql
  CREATE TABLE IF NOT EXISTS table_name (
    id TEXT PRIMARY KEY,
    userId TEXT NOT NULL,
    -- ä¸šåŠ¡å­—æ®µ
    createdAt TEXT DEFAULT CURRENT_TIMESTAMP,
    updatedAt TEXT DEFAULT CURRENT_TIMESTAMP
  );
  CREATE INDEX IF NOT EXISTS idx_table_userId ON table_name(userId);
  ```
- **å¿…é¡»**ä½¿ç”¨ Prepared Statement é˜²æ­¢ SQL æ³¨å…¥
  ```typescript
  // âœ… æ­£ç¡®
  const stmt = this.db.prepare('SELECT * FROM notes WHERE userId = ?')
  return stmt.all(userId)
  
  // âŒ é”™è¯¯
  return this.db.exec(`SELECT * FROM notes WHERE userId = '${userId}'`)
  ```

### 2. äº‘ç«¯å­˜å‚¨ï¼ˆPostgreSQLï¼‰
- **ORM**: Prisma
- **ä½ç½®**: `packages/database/prisma/schema.prisma`
- **è¿ç§»**: `pnpm prisma migrate dev --name xxx`

### 3. æœåŠ¡å®ç°ä½ç½®
- **æœ¬åœ°æœåŠ¡**: `apps/desktop/electron/services/`
- **IPC å¤„ç†å™¨**: `apps/desktop/electron/ipc/`
- **äº‘ç«¯æœåŠ¡**: `packages/server/src/services/`
- **API è·¯ç”±**: `packages/server/src/routes/`
- **å‰ç«¯æœåŠ¡**: `apps/desktop/src/services/`

## ğŸ”§ å¼€å‘æµç¨‹

### 0. ä»»åŠ¡å®Œæˆè¡Œä¸ºè§„èŒƒ
- **ç¦æ­¢**åœ¨å®Œæˆä»»åŠ¡åè‡ªåŠ¨æ‰§è¡Œé‡å¯å‘½ä»¤ï¼ˆå¦‚ `pnpm dev`ï¼‰
- **å¿…é¡»**åœ¨ä»»åŠ¡å®Œæˆåå‘ŠçŸ¥ç”¨æˆ·éœ€è¦æ‰‹åŠ¨é‡å¯
- **æç¤ºæ ¼å¼**: "âœ… ä¿®æ”¹å®Œæˆï¼è¯·æ‰‹åŠ¨æ‰§è¡Œ `pnpm dev` é‡å¯åº”ç”¨ä»¥æŸ¥çœ‹æ•ˆæœã€‚"
- **åŸå› **: 
  - ç”¨æˆ·å¯èƒ½éœ€è¦æŸ¥çœ‹ä»£ç æˆ–è¿›è¡Œå…¶ä»–æ“ä½œ
  - é¿å…é¢‘ç¹é‡å¯å¯¼è‡´çš„è¿›ç¨‹æ··ä¹±
  - è®©ç”¨æˆ·æŒæ§å¼€å‘æµç¨‹èŠ‚å¥

```typescript
// âœ… æ­£ç¡® - å‘ŠçŸ¥ç”¨æˆ·æ‰‹åŠ¨é‡å¯
console.log('âœ… ä¿®æ”¹å®Œæˆï¼è¯·æ‰‹åŠ¨æ‰§è¡Œ `pnpm dev` é‡å¯åº”ç”¨ã€‚')

// âŒ é”™è¯¯ - è‡ªåŠ¨é‡å¯
await runCommand('pnpm dev')
```

### 0.1. æ–‡ä»¶ç®¡ç†è§„èŒƒ
- **ç¦æ­¢åˆ é™¤å‚è€ƒé¡¹ç›®**: `Chaterm-main`ã€`electron-egg-master`ã€`Roo-Code-main`ã€`lobe-chat-main`ã€`vscode-main` ç›®å½•æ˜¯é‡è¦çš„å‚è€ƒé¡¹ç›®ï¼Œ**ç»å¯¹ä¸èƒ½**åˆ é™¤æˆ–ç§»åŠ¨
- **å‚è€ƒé¡¹ç›®ç”¨é€”**: 
  - ä½œä¸º Electron + Vue3 æ¶æ„çš„å‚è€ƒå®ç°
  - æä¾›æ‰“åŒ…é…ç½®çš„å‚è€ƒ
  - å¸®åŠ©è§£å†³æŠ€æœ¯éš¾é¢˜æ—¶çš„å¯¹ç…§ä»£ç 
- **ä½ç½®**: é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `Chaterm-main/` æˆ– `d:\git-projects\ai-ssh-assistant\Chaterm-main\`

```bash
# âŒ ç¦æ­¢æ“ä½œ
rm -rf Chaterm-main/
git rm -rf Chaterm-main/

# âœ… æ­£ç¡® - ä¿ç•™å‚è€ƒé¡¹ç›®
# éœ€è¦æ—¶å¯ä»¥æŸ¥çœ‹å‚è€ƒé¡¹ç›®çš„å®ç°
cat Chaterm-main/package.json
```

### 1. åŒå­˜å‚¨å®ç°è§„èŒƒ

**æ ¸å¿ƒåŸåˆ™**ï¼šå®ç°ä»»ä½•åç«¯åŠŸèƒ½æ—¶ï¼Œ**å¿…é¡»**åŒæ—¶æä¾›æœ¬åœ°å­˜å‚¨å’Œè¿œç¨‹å­˜å‚¨ä¸¤ç§å®ç°æ–¹å¼ã€‚

#### ä¸ºä»€ä¹ˆéœ€è¦åŒå­˜å‚¨ï¼Ÿ
- æœ¬åœ°æ¨¡å¼ï¼ˆLocalï¼‰ï¼šä½¿ç”¨ SQLite + IPCï¼Œæ— éœ€æœåŠ¡å™¨ï¼Œé€‚åˆå•æœºä½¿ç”¨
- äº‘ç«¯æ¨¡å¼ï¼ˆRemoteï¼‰ï¼šä½¿ç”¨ PostgreSQL + HTTP APIï¼Œæ”¯æŒå¤šè®¾å¤‡åŒæ­¥

#### å®Œæ•´å®ç°æ¸…å•

**æœ¬åœ°å­˜å‚¨å®ç°ï¼ˆLocalï¼‰**ï¼š
1. âœ… å®šä¹‰ SQLite è¡¨ç»“æ„ï¼ˆ`apps/desktop/electron/services/your.service.ts`ï¼‰
2. âœ… å®ç°æœ¬åœ°æœåŠ¡é€»è¾‘ï¼ˆä½¿ç”¨ better-sqlite3ï¼‰
3. âœ… æ³¨å†Œ IPC å¤„ç†å™¨ï¼ˆ`apps/desktop/electron/ipc/your-handlers.ts`ï¼‰
4. âœ… æ›´æ–° Preload APIï¼ˆ`apps/desktop/electron/preload/index.ts`ï¼‰
5. âœ… æ›´æ–° TypeScript ç±»å‹ï¼ˆ`apps/desktop/src/types/electron.d.ts`ï¼‰
6. âœ… å®ç° LocalImpl æœåŠ¡ï¼ˆ`apps/desktop/src/services/your.service.ts`ï¼‰

**è¿œç¨‹å­˜å‚¨å®ç°ï¼ˆRemoteï¼‰**ï¼š
1. âœ… å®šä¹‰ Prisma Schemaï¼ˆ`packages/database/prisma/schema.prisma`ï¼‰
2. âœ… è¿è¡Œæ•°æ®åº“è¿ç§»ï¼ˆ`pnpm prisma migrate dev`ï¼‰
3. âœ… å®ç°åç«¯æœåŠ¡ï¼ˆ`packages/server/src/services/your.service.ts`ï¼‰
4. âœ… åˆ›å»º API è·¯ç”±ï¼ˆ`packages/server/src/routes/your.routes.ts`ï¼‰
5. âœ… å®ç° ApiImpl æœåŠ¡ï¼ˆ`apps/desktop/src/services/your.service.ts`ï¼‰

**æœåŠ¡æ•´åˆ**ï¼š
```typescript
// apps/desktop/src/services/your.service.ts
export interface IYourService {
  getData(): Promise<Data[]>
  createData(data: CreateDto): Promise<Data>
  // ... å…¶ä»–æ–¹æ³•
}

// æœ¬åœ°å®ç° - ä½¿ç”¨ IPC + SQLite
class YourLocalImpl extends BaseLocalImpl implements IYourService {
  async getData(): Promise<Data[]> {
    const userId = this.getUserId() // è‡ªåŠ¨è·å– 'local-user'
    return this.electronAPI.your.getData(userId)
  }
}

// äº‘ç«¯å®ç° - ä½¿ç”¨ HTTP API + PostgreSQL
class YourApiImpl extends BaseApiImpl implements IYourService {
  async getData(): Promise<Data[]> {
    const response = await this.apiService.get('/your/data')
    return response.data
  }
}

// è‡ªåŠ¨åˆ‡æ¢
export const yourService = createService<IYourService>(
  'YourService',
  YourLocalImpl,
  YourApiImpl
)
```

#### å®ç°é¡ºåºå»ºè®®

1. **å…ˆå®ç°æœ¬åœ°å­˜å‚¨**ï¼ˆå¿«é€ŸéªŒè¯åŠŸèƒ½ï¼‰
   - åˆ›å»º SQLite è¡¨
   - å®ç°æœ¬åœ°æœåŠ¡å’Œ IPC
   - æµ‹è¯•åŸºæœ¬åŠŸèƒ½

2. **åå®ç°è¿œç¨‹å­˜å‚¨**ï¼ˆæ”¯æŒäº‘ç«¯åŒæ­¥ï¼‰
   - å®šä¹‰ Prisma Schema
   - å®ç° API å’Œåç«¯æœåŠ¡
   - æµ‹è¯•äº‘ç«¯åŠŸèƒ½

3. **éªŒè¯åŒæ¨¡å¼åˆ‡æ¢**
   - æµ‹è¯•æœ¬åœ°æ¨¡å¼è¿è¡Œæ­£å¸¸
   - æµ‹è¯•äº‘ç«¯æ¨¡å¼è¿è¡Œæ­£å¸¸
   - æµ‹è¯•æ¨¡å¼åˆ‡æ¢æ— ç¼

#### å¸¸è§é”™è¯¯

âŒ **åªå®ç°æœ¬åœ°æˆ–åªå®ç°äº‘ç«¯**
```typescript
// é”™è¯¯ï¼šåªæœ‰æœ¬åœ°å®ç°
class YourLocalImpl implements IYourService { ... }
export const yourService = new YourLocalImpl()
```

âœ… **åŒæ—¶æä¾›ä¸¤ç§å®ç°**
```typescript
// æ­£ç¡®ï¼šæä¾›åŒå®ç°
export const yourService = createService<IYourService>(
  'YourService',
  YourLocalImpl,
  YourApiImpl
)
```

### 2. æ·»åŠ æ–°åŠŸèƒ½æ¨¡å—ï¼ˆè¯¦ç»†æ­¥éª¤ï¼‰
**æœ¬åœ°å­˜å‚¨éƒ¨åˆ†**ï¼š
1. å®šä¹‰æœåŠ¡æ¥å£ (`apps/desktop/src/services/your.service.ts`)
2. å®ç°æœ¬åœ°æœåŠ¡ (`apps/desktop/electron/services/your.service.ts`)
3. æ³¨å†Œ IPC å¤„ç†å™¨ (`apps/desktop/electron/ipc/your-handlers.ts`)
4. æ›´æ–° Preload è„šæœ¬ (`apps/desktop/electron/preload/index.ts`)
5. æ›´æ–°ç±»å‹å®šä¹‰ (`apps/desktop/src/types/electron.d.ts`)

**è¿œç¨‹å­˜å‚¨éƒ¨åˆ†**ï¼š
6. å®šä¹‰ Prisma Schema (`packages/database/prisma/schema.prisma`)
7. å®ç°äº‘ç«¯æœåŠ¡ (`packages/server/src/services/your.service.ts`)
8. åˆ›å»º API è·¯ç”± (`packages/server/src/routes/your.routes.ts`)

**æœåŠ¡æ•´åˆ**ï¼š
9. å®ç°åŒæ¨¡å¼æœåŠ¡ï¼ˆLocalImpl + ApiImplï¼‰
10. åˆ›å»º UI ç»„ä»¶

### 3. Git æäº¤è§„èŒƒ
- **ç¦æ­¢è‡ªåŠ¨æäº¤å’Œæ¨é€**: é™¤éç”¨æˆ·æ˜ç¡®è¦æ±‚ï¼Œå¦åˆ™ä¸è¦æ‰§è¡Œ `git add`ã€`git commit` æˆ– `git push`
- **ä»»åŠ¡å®Œæˆå**: å‘ŠçŸ¥ç”¨æˆ·"âœ… ä»»åŠ¡å®Œæˆï¼å¦‚éœ€æäº¤ä»£ç ï¼Œè¯·æ‰‹åŠ¨æ‰§è¡Œ git æ“ä½œã€‚"
- **commit ä¿¡æ¯è¦ç®€çŸ­æ˜ç¡®**ï¼Œè¯´æ˜åšäº†ä»€ä¹ˆ
- **ä¸è¦**è·³è¿‡ hooksï¼ˆé™¤éæ˜ç¡®éœ€è¦ï¼‰
- **ä¸è¦** force push åˆ° main/masterï¼ˆé™¤éç”¨æˆ·æ˜ç¡®è¦æ±‚ï¼‰

```bash
# âœ… æ­£ç¡® - ä»…åœ¨ç”¨æˆ·æ˜ç¡®è¦æ±‚æ—¶æ‰§è¡Œ
# ç”¨æˆ·: "æäº¤ä»£ç å¹¶æ¨é€"
git add . && git commit -m "ç®€çŸ­è¯´æ˜" && git push

# âŒ é”™è¯¯ - ä»»åŠ¡å®Œæˆåè‡ªåŠ¨æäº¤
# å®ŒæˆåŠŸèƒ½å®ç°åè‡ªåŠ¨æ‰§è¡Œ git commit
```

### 4. è°ƒè¯•æŠ€å·§
- **ä¸è¦æ€€ç–‘**ä»£ç æœªç”Ÿæ•ˆæ˜¯å› ä¸ºæ²¡æœ‰ç¼–è¯‘æˆ–é‡å¯
- **ä½¿ç”¨**è¯¦ç»†æ—¥å¿—è®°å½•å…³é”®èŠ‚ç‚¹
- **éªŒè¯æ•°æ®æµ**:
  - æœ¬åœ°: ç»„ä»¶ â†’ Service â†’ IPC â†’ ä¸»è¿›ç¨‹ â†’ SQLite
  - äº‘ç«¯: ç»„ä»¶ â†’ Service â†’ API â†’ åç«¯ â†’ Prisma â†’ PostgreSQL

## âš ï¸ å¸¸è§é”™è¯¯é¿å…

### 1. ç¦æ­¢çš„æ“ä½œ
- âŒ åˆ›å»ºæˆ–ä½¿ç”¨ Pinia Storeï¼ˆå·²åºŸå¼ƒï¼‰
- âŒ åœ¨ç»„ä»¶ä¸­æ‰‹åŠ¨åˆ¤æ–­å­˜å‚¨æ¨¡å¼
- âŒ æ‰‹åŠ¨ä¼ é€’ userId å‚æ•°
- âŒ æ‰‹åŠ¨å¤„ç† Token
- âŒ API è·¯å¾„æ·»åŠ é‡å¤çš„ `/api` å‰ç¼€
- âŒ å­—ç¬¦ä¸²æ‹¼æ¥ SQLï¼ˆä½¿ç”¨ Prepared Statementï¼‰
- âŒ ç›´æ¥è¿æ¥è¿œç¨‹æ•°æ®åº“ï¼ˆä½¿ç”¨ APIï¼‰
- âŒ ä¸ºæ¯ä¸ªè·¯ç”±é‡å¤å®šä¹‰è¯¦ç»†çš„ response schema
- âŒ åœ¨ response schema ä¸­å®šä¹‰ `type: 'object'` è€Œä¸åŠ  `additionalProperties: true`

### 2. å¿…é¡»çš„æ“ä½œ
- âœ… ä½¿ç”¨ç»Ÿä¸€æœåŠ¡æ¥å£
- âœ… æœåŠ¡å±‚è‡ªåŠ¨å¤„ç† userId å’Œ Token
- âœ… åŒæ­¥æ›´æ–°ç±»å‹å®šä¹‰
- âœ… ä½¿ç”¨ Prepared Statement
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- âœ… æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
- âœ… è·¯ç”±ä½¿ç”¨ç»Ÿä¸€çš„ `successResponseSchema`

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [Service Architecture](./docs/development/service-architecture.md) - æœåŠ¡æ¶æ„è¯¦ç»†è¯´æ˜
- [Database Storage](./docs/development/database-storage.md) - æ•°æ®å­˜å‚¨æ¶æ„
- [Best Practices](./docs/development/best-practices.md) - æœ€ä½³å®è·µ
- [Getting Started](./docs/development/getting-started.md) - å¼€å‘å…¥é—¨

## ğŸ” ä»£ç æ£€æŸ¥æ¸…å•

### æ·»åŠ æ–°åŠŸèƒ½å‰æ£€æŸ¥
- [ ] æ˜¯å¦éœ€è¦å®šä¹‰æœåŠ¡æ¥å£ï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦æœ¬åœ°å’Œäº‘ç«¯ä¸¤ç§å®ç°ï¼Ÿ
- [ ] ç±»å‹å®šä¹‰æ˜¯å¦åŒæ­¥æ›´æ–°ï¼Ÿ
- [ ] IPC å‘½åæ˜¯å¦ç¬¦åˆè§„èŒƒï¼Ÿ
- [ ] API è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆæ— é‡å¤å‰ç¼€ï¼‰ï¼Ÿ
- [ ] è·¯ç”±æ˜¯å¦ä½¿ç”¨ç»Ÿä¸€çš„ `successResponseSchema`ï¼Ÿ

### æäº¤ä»£ç å‰æ£€æŸ¥
- [ ] æ˜¯å¦æœ‰ TypeScript é”™è¯¯ï¼Ÿ
- [ ] æ˜¯å¦æœ‰ linter é”™è¯¯ï¼Ÿ
- [ ] userId å’Œ Token æ˜¯å¦ç”±æœåŠ¡å±‚å¤„ç†ï¼Ÿ
- [ ] æ˜¯å¦æœ‰æœªæ¸…ç†çš„äº‹ä»¶ç›‘å¬å™¨ï¼Ÿ
- [ ] æ˜¯å¦æœ‰ SQL æ³¨å…¥é£é™©ï¼Ÿ
- [ ] æ˜¯å¦æœ‰ç¡¬ç¼–ç çš„é…ç½®ï¼ˆåº”ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼‰ï¼Ÿ

### ç»„ä»¶å¼€å‘æ£€æŸ¥
- [ ] æ˜¯å¦ç›´æ¥ä½¿ç”¨æœåŠ¡è€Œé Storeï¼Ÿ
- [ ] æ˜¯å¦ä½¿ç”¨ Composables ç®¡ç†å…¨å±€çŠ¶æ€ï¼Ÿ
- [ ] æ˜¯å¦æ­£ç¡®æ¸…ç†å‰¯ä½œç”¨ï¼ˆonBeforeUnmountï¼‰ï¼Ÿ
- [ ] æ˜¯å¦æœ‰å®Œæ•´çš„é”™è¯¯å¤„ç†ï¼Ÿ

## ğŸ“„ æ–‡æ¡£è§„èŒƒ

### ç¦æ­¢åˆ›å»ºæ€»ç»“æ–‡æ¡£
- **ç¦æ­¢**åœ¨ä»»åŠ¡å®Œæˆååˆ›å»ºæ€»ç»“æ–‡æ¡£ï¼ˆå¦‚ `*_FIX.md`ã€`*_COMPLETE.md`ã€`*_SUMMARY.md` ç­‰ï¼‰
- **åŸå› **: 
  - æ–‡æ¡£å®¹æ˜“è¿‡æ—¶ä¸”éš¾ä»¥ç»´æŠ¤
  - Git æäº¤å†å²å·²ç»è®°å½•äº†æ‰€æœ‰ä¿®æ”¹
  - é‡è¦çš„æ¶æ„è¯´æ˜åº”è¯¥å†™åœ¨ä»£ç æ³¨é‡Šä¸­
  - é¡¹ç›®è§„èŒƒç»Ÿä¸€è®°å½•åœ¨ `.cursor/rules/my-rules.mdc`

```bash
# âŒ ç¦æ­¢åˆ›å»º
apps/desktop/SSH_RECONNECT_FIX.md
apps/desktop/THEME_OPTIMIZATION.md
apps/desktop/SYSTEM_MESSAGE_HIDE_FIX.md

# âœ… æ­£ç¡®åšæ³•
# 1. åœ¨ä»£ç ä¸­æ·»åŠ å…³é”®æ³¨é‡Š
// ä¿®å¤ SSH é‡è¿åè¿æ¥ ID ä¸æ›´æ–°çš„é—®é¢˜
// ä½¿ç”¨ currentConnectionId è€Œä¸æ˜¯ actualConnectionId
:connection-id="currentConnectionId"

# 2. æäº¤æ—¶å†™æ¸…æ™°çš„ commit message
git commit -m "fix: SSH é‡è¿å AI åŠ©æ‰‹è¿æ¥ ID ä¸æ›´æ–°

- ä¿®æ”¹ TerminalView ä¼ é€’ç»™ AI åŠ©æ‰‹çš„è¿æ¥ ID
- ä»å›ºå®šçš„ actualConnectionId æ”¹ä¸ºåŠ¨æ€çš„ currentConnectionId
- æ·»åŠ  watch ç›‘å¬è¿æ¥ ID å˜åŒ–"
```

### ä½•æ—¶åˆ›å»ºæ–‡æ¡£
**ä»…åœ¨ä»¥ä¸‹æƒ…å†µ**ä¸‹åˆ›å»ºæ–‡æ¡£ï¼š
- é‡å¤§æ¶æ„å˜æ›´ï¼ˆåº”æ›´æ–° `README.md` æˆ– `.cursor/rules/my-rules.mdc`ï¼‰
- API æ–‡æ¡£ï¼ˆä½¿ç”¨ OpenAPI/Swagger è‡ªåŠ¨ç”Ÿæˆï¼‰
- ç”¨æˆ·ä½¿ç”¨æŒ‡å—ï¼ˆ`docs/` ç›®å½•ï¼‰

---

**æœ€åæ›´æ–°**: 2025-10-11
**é¡¹ç›®æ¶æ„ç‰ˆæœ¬**: v2.0 (åŒæ¨¡å¼æœåŠ¡æ¶æ„)
