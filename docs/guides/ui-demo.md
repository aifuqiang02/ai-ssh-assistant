# 新版 UI 功能演示

## 快速预览

新版 AI 聊天界面已经完成！以下是主要功能的演示。

## 1. 基础对话

### 示例 1：简单问答

**用户输入**：
```
你好，请介绍一下你自己
```

**AI 响应**：
```
你好！👋 我是 AI 助手，专门设计用来帮助你管理和操作 SSH 服务器。

我可以帮你：
- 执行 SSH 命令
- 读取和分析文件
- 查看目录结构
- 监控系统状态
- 解决技术问题

有什么我可以帮助你的吗？
```

**界面效果**：
- 用户消息：蓝色图标 + "你" 标识
- AI 消息：绿色机器人图标 + "AI 助手" 标识 + 时间戳
- Markdown 格式正确渲染（列表、Emoji 等）

---

## 2. SSH 命令执行

### 示例 2：查看当前目录

**用户输入**：
```
执行 pwd 命令
```

**AI 响应流程**：

1. **AI 解析意图**
   ```
   我将执行 pwd 命令来查看当前工作目录。
   ```

2. **显示工具卡片**
   ```
   ┌─────────────────────────────────────┐
   │ 🖥️ SSH 命令执行                     │
   ├─────────────────────────────────────┤
   │ command: pwd                        │
   └─────────────────────────────────────┘
   ```

3. **工具批准对话框弹出**
   - 显示工具名称：`execute_ssh_command`
   - 显示参数：`command: pwd`
   - 说明：AI 助手请求执行 SSH 命令: pwd
   - 按钮：[拒绝] [批准执行]

4. **用户批准后，显示执行结果**
   ```
   ┌─────────────────────────────────────┐
   │ 🖥️ SSH 命令执行                     │
   ├─────────────────────────────────────┤
   │ command: pwd                        │
   ├─────────────────────────────────────┤
   │ ✅ 执行成功                          │
   │                                     │
   │ /home/user                          │
   └─────────────────────────────────────┘
   ```

5. **AI 继续分析**
   ```
   当前工作目录是 /home/user。这是你的用户主目录。
   需要我帮你查看这个目录下有哪些文件吗？
   ```

---

## 3. 复杂命令

### 示例 3：查看日志文件

**用户输入**：
```
帮我查看 nginx 的最新错误日志
```

**AI 执行步骤**：

1. **第一步：列出日志目录**
   ```
   ┌─────────────────────────────────────┐
   │ 🖥️ SSH 命令执行                     │
   ├─────────────────────────────────────┤
   │ command: ls -lt /var/log/nginx/     │
   ├─────────────────────────────────────┤
   │ ✅ 执行成功                          │
   │                                     │
   │ -rw-r--r-- 1 root root 15K Oct 6    │
   │ error.log                           │
   │ -rw-r--r-- 1 root root 1.2M Oct 6   │
   │ access.log                          │
   └─────────────────────────────────────┘
   ```

2. **第二步：读取错误日志**
   ```
   ┌─────────────────────────────────────┐
   │ 🖥️ SSH 命令执行                     │
   ├─────────────────────────────────────┤
   │ command: tail -50 /var/log/nginx/   │
   │          error.log                  │
   ├─────────────────────────────────────┤
   │ ✅ 执行成功                          │
   │                                     │
   │ 2025/10/06 10:23:15 [error] ...     │
   │ 2025/10/06 10:24:32 [error] ...     │
   └─────────────────────────────────────┘
   ```

3. **第三步：分析结果**
   ```
   我查看了最新的 50 行错误日志，发现以下问题：

   1. **连接超时错误**（10次）
      - 原因：上游服务器响应慢
      - 建议：增加 proxy_timeout 配置

   2. **404 错误**（5次）
      - 原因：请求的静态资源不存在
      - 建议：检查文件路径配置

   需要我帮你修改 nginx 配置吗？
   ```

---

## 4. 代码展示

### 示例 4：显示配置文件

**用户输入**：
```
显示 nginx 的主配置文件
```

**AI 响应**（包含代码高亮）：

````
我来读取 nginx 的配置文件：

```nginx
user www-data;
worker_processes auto;
pid /run/nginx.pid;

events {
    worker_connections 768;
    # multi_accept on;
}

http {
    ##
    # Basic Settings
    ##
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;

    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    ##
    # Logging Settings
    ##
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;

    ##
    # Gzip Settings
    ##
    gzip on;
}
```

这是一个标准的 nginx 配置文件。需要我解释某个配置项吗？
````

**界面效果**：
- 代码块有语法高亮（nginx 语法）
- 行号自动显示
- 可以滚动查看长代码
- 代码字体为等宽字体

---

## 5. 错误处理

### 示例 5：命令执行失败

**用户输入**：
```
删除 /root/important.txt 文件
```

**AI 执行**：

1. **工具批准对话框（带警告）**
   ```
   ┌─────────────────────────────────────┐
   │ ⚠️ 警告：潜在危险操作               │
   │ 此命令可能会修改或删除文件，       │
   │ 请仔细确认后再批准执行。           │
   └─────────────────────────────────────┘
   ```

2. **执行失败的显示**
   ```
   ┌─────────────────────────────────────┐
   │ 🖥️ SSH 命令执行                     │
   ├─────────────────────────────────────┤
   │ command: rm /root/important.txt     │
   ├─────────────────────────────────────┤
   │ ❌ 执行失败                          │
   │                                     │
   │ Permission denied                   │
   └─────────────────────────────────────┘
   ```

3. **AI 分析和建议**
   ```
   命令执行失败，原因是权限不足。

   可能的解决方案：
   1. 使用 sudo 提升权限：`sudo rm /root/important.txt`
   2. 切换到 root 用户
   3. 修改文件权限

   需要我尝试使用 sudo 执行吗？
   ```

---

## 6. 多轮对话

### 示例 6：连续的任务

**对话流程**：

```
用户: 检查服务器磁盘使用情况
AI:   执行 df -h 命令...
      [显示结果]
      发现 /var 分区使用了 85%，需要清理。

用户: 找出占用空间最大的目录
AI:   执行 du -sh /var/* | sort -h...
      [显示结果]
      /var/log 目录占用 15GB，是最大的。

用户: 查看日志目录详情
AI:   执行 ls -lh /var/log...
      [显示结果]
      找到几个大文件：
      - syslog.1: 5.2GB
      - nginx/access.log: 3.8GB

用户: 可以帮我清理旧日志吗
AI:   我可以帮你压缩这些日志文件。
      [显示工具批准请求]
      是否批准执行？
```

**界面特点**：
- 完整的上下文保持
- 每条消息独立显示
- 工具调用结果关联到对应消息
- 可以向上滚动查看历史

---

## 7. 实时流式输出

### 示例 7：生成长文本

**用户输入**：
```
写一个 Python 脚本来监控服务器 CPU 使用率
```

**AI 响应**（流式显示）：

```
我来为你编写一个 Python 脚本：

```python
import psutil
import time

def monitor_cpu():
    """
    监控服务器 CPU 使用率
    """
    print("开始监控 CPU 使用率...")
    
    while True:
        # 获取 CPU 使用率
        cpu_percent = psutil.cpu_percent(interval=1)
        
        # 打印结果
        print(f"CPU 使用率: {cpu_percent}%")
        
        # 如果超过阈值，发出警告
        if cpu_percent > 80:
            print("⚠️ 警告：CPU 使用率过高！")
        
        # 等待 5 秒
        time.sleep(5)

if __name__ == "__main__":
    monitor_cpu()
```

这个脚本会：
1. 每 5 秒检查一次 CPU 使用率
2. 实时显示当前使用率
3. 当使用率超过 80% 时发出警告

需要我帮你将这个脚本部署到服务器吗？
```

**界面效果**：
- 文本逐字显示（打字机效果）
- 代码块语法高亮
- 自动滚动跟随
- 流畅的用户体验

---

## 8. 特殊功能

### 加载状态

当 AI 正在生成响应时：
```
AI 助手 ⚫ ⚫ ⚫
```
（三个点跳动动画）

### 工具执行进度

当工具正在执行时：
```
🔄 Executing command: ls -la
```
（旋转图标 + 进度文本）

### 空状态

当没有消息时：
```
        💬
   开始与 AI 助手对话
SSH终端AI助手（支持工具调用）
```

---

## 使用技巧

### 1. 快速输入

使用 `Ctrl+Enter` 快速发送消息，无需点击按钮。

### 2. 多行输入

直接在输入框中换行，支持输入复杂的命令或问题。

### 3. 查看历史

向上滚动查看之前的对话历史和工具执行结果。

### 4. 复制代码

悬停在代码块上，右键复制需要的代码。

### 5. 取消生成

如果 AI 响应太长，可以点击"生成中..."按钮停止。

---

## 总结

新版 UI 带来了：

✨ **更美的界面** - 现代化设计，赏心悦目  
🔧 **更强的功能** - 完整的工具调用支持  
📝 **更好的可读性** - Markdown 和代码高亮  
⚡ **更快的响应** - 流式输出，实时反馈  
🎮 **更好的交互** - 直观的操作，流畅的体验  

立即体验新版 UI，享受更好的 AI 助手服务！🎉


