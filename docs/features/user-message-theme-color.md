# 用户消息主题色背景功能

## 📝 功能说明

用户发送的消息现在会自动应用主题色背景，与设置中配置的主题色保持一致。

## 🎨 视觉效果

### 用户消息
- **背景色**：主题色的 8% 透明版本（`rgba(主题色, 0.08)`）
- **左边框**：3px 实色主题色边框
- **圆角**：6px 圆角
- **内边距**：8px（上下）× 10px（左右）

### 示例效果

```
┌─────────────────────────────────────┐
│ 🔵 你             10:30 AM          │
│ ┃                                   │ ← 左边框（主题色）
│ ┃ 你好，请帮我查看服务器状态        │
│ ┃                                   │
└─────────────────────────────────────┘
      ↑ 背景色（主题色 8% 透明）
```

## 🎯 主题色适配

系统支持多种主题色，用户消息背景会自动适配：

| 主题 | 主题色 | 背景效果 |
|------|--------|----------|
| **蓝色**（默认） | `#007acc` | 淡蓝色背景 |
| **绿色** | `#10b981` | 淡绿色背景 |
| **紫色** | `#8b5cf6` | 淡紫色背景 |
| **橙色** | `#f59e0b` | 淡橙色背景 |
| **红色** | `#ef4444` | 淡红色背景 |

## 💻 技术实现

### CSS 代码

```css
/* 用户消息背景（使用主题色） */
.message-user .message-container {
  background: rgba(var(--vscode-accent-rgb, 0, 122, 204), 0.08);
  border-left: 3px solid var(--vscode-accent);
  border-radius: 6px;
  padding: 8px 10px;
  margin-left: 0;
}
```

### 工作原理

1. **CSS 变量**：使用 `--vscode-accent` 获取当前主题色
2. **RGB 变量**：使用 `--vscode-accent-rgb` 获取 RGB 值
3. **透明背景**：通过 `rgba()` 创建 8% 透明的背景
4. **回退值**：提供默认蓝色 `0, 122, 204` 作为回退

### 主题色定义位置

主题色在以下位置定义：
- `apps/desktop/src/stores/theme.ts` - 主题色配置
- `apps/desktop/src/assets/styles/main.css` - 全局 CSS 变量

## 🔍 对比效果

### 之前
```
用户消息：纯白色背景，无特殊标识
AI 消息：纯白色背景，无特殊标识
```
❌ 不易区分

### 现在
```
用户消息：淡蓝色背景（或其他主题色） + 蓝色左边框
AI 消息：纯白色背景
```
✅ 清晰可辨

## 📊 识别度提升

| 指标 | 之前 | 现在 | 提升 |
|------|------|------|------|
| **视觉区分度** | 低 | 高 | ⭐⭐⭐⭐⭐ |
| **用户识别速度** | 慢 | 快 | ⭐⭐⭐⭐ |
| **界面美观度** | 一般 | 优秀 | ⭐⭐⭐⭐⭐ |

## 🎮 用户体验

### 优点

1. **快速识别**：一眼就能看出哪些是自己发的消息
2. **主题统一**：颜色与全局主题保持一致
3. **视觉层次**：背景和边框形成清晰的视觉层次
4. **不突兀**：8% 透明度既明显又不刺眼

### 适用场景

- ✅ 长对话中快速定位自己的消息
- ✅ 多轮对话时区分角色
- ✅ 回看历史对话时快速识别
- ✅ 截图分享时保持专业外观

## 🔧 自定义建议

如果需要调整效果，可以修改以下参数：

```css
/* 背景透明度（0.08 = 8%） */
background: rgba(var(--vscode-accent-rgb), 0.08);
                                           ^^^^
                                        可调整为 0.05 - 0.15

/* 左边框宽度（3px） */
border-left: 3px solid var(--vscode-accent);
             ^^^
          可调整为 2px - 5px

/* 圆角大小（6px） */
border-radius: 6px;
               ^^^
            可调整为 4px - 8px

/* 内边距 */
padding: 8px 10px;
         ^^^  ^^^
       上下   左右
```

## 📱 响应式设计

背景色在不同场景下都能正常工作：

- ✅ **正常窗口**：完整显示
- ✅ **小窗口**：自适应缩放
- ✅ **全屏**：保持比例
- ✅ **开发者工具打开**：不影响显示

## 🌈 主题切换

当用户切换主题色时：

1. 系统自动更新 `--vscode-accent` 变量
2. 用户消息背景色实时更新
3. 无需刷新页面
4. 所有历史消息同步更新

## ✨ 最佳实践

### 推荐配置

- **背景透明度**：8%（默认）
  - 太低（< 5%）：不够明显
  - 太高（> 15%）：过于突出

- **边框宽度**：3px（默认）
  - 太细（< 2px）：不够清晰
  - 太粗（> 5px）：过于抢眼

### 颜色搭配

| 场景 | 推荐主题色 | 理由 |
|------|-----------|------|
| 日常使用 | 蓝色 | 经典、专业 |
| 编程开发 | 绿色 | 护眼、舒适 |
| 创意工作 | 紫色 | 时尚、个性 |
| 重要项目 | 红色 | 醒目、警示 |

## 📝 更新日志

**v2.1.0** - 2025-10-06
- ✅ 新增用户消息主题色背景
- ✅ 添加左边框强化识别
- ✅ 支持所有主题色自动适配
- ✅ 优化内边距和圆角

## 🎯 未来规划

- [ ] AI 消息也支持自定义背景色
- [ ] 支持自定义透明度
- [ ] 支持自定义边框样式
- [ ] 支持消息气泡样式

---

**效果预览**：重启应用或刷新页面后生效！

